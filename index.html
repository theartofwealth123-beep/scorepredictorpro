<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ScorePredictor Pro • 5M Sims</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif; background: #020617; color: #e5e7eb; }
    .glass { background: rgba(15,23,42,0.9); backdrop-filter: blur(18px); border-radius: 1.75rem; border: 1px solid rgba(148,163,184,0.4); }
    .btn-main { background: linear-gradient(135deg,#6366f1,#ec4899); box-shadow: 0 18px 45px rgba(79,70,229,0.65); }
    .btn-main:hover { transform: translateY(-2px); box-shadow: 0 24px 60px rgba(79,70,229,0.8); }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 text-slate-100 antialiased">

  <!-- NAVBAR -->
  <header class="border-b border-slate-800/70 bg-slate-950/70 backdrop-blur">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-2">
        <div class="w-9 h-9 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center font-black text-xl">
          S
        </div>
        <div>
          <div class="font-bold text-lg tracking-tight">ScorePredictor Pro</div>
          <div class="text-xs text-slate-400 uppercase tracking-[0.2em]">5,000,000 SIMS</div>
        </div>
      </div>
      <nav class="flex items-center gap-4 text-sm">
        <a href="/" class="text-slate-100 font-medium">Calculator</a>
        <a href="/scores.html" class="text-slate-400 hover:text-slate-100">Scores</a>
        <a href="/profile.html" class="text-slate-400 hover:text-slate-100">Profile</a>
        <button id="logout-btn" class="text-xs text-slate-400 hover:text-slate-100 border border-slate-700/80 rounded-full px-3 py-1">
          Logout
        </button>
      </nav>
    </div>
  </header>

  <!-- MAIN -->
  <main class="max-w-6xl mx-auto px-4 pt-8 pb-16">
    <!-- Status / CTA -->
    <div id="logged-out" class="hidden mb-4 rounded-xl border border-amber-500/50 bg-amber-500/10 px-4 py-3 text-sm text-amber-100 flex items-center justify-between">
      <span class="font-medium">You’re not logged in.</span>
      <button
        class="underline underline-offset-2"
        onclick="window.location.href='/auth-callback'"
      >Log in / Start Trial</button>
    </div>

    <div id="free-only" class="hidden mb-4 rounded-xl border border-sky-500/50 bg-sky-500/10 px-4 py-3 text-sm text-sky-100">
      <span class="font-medium">Free tier:</span>
      You can view live scores and free edges on the Scores page. The 5M-sim calculator is available for subscribers only.
    </div>

    <!-- HERO -->
    <section class="mb-8">
      <h1 class="text-3xl md:text-4xl font-black tracking-tight text-slate-50">
        5,000,000-Simulation Edge Engine
      </h1>
      <p class="mt-2 text-sm md:text-base text-slate-400 max-w-2xl">
        Choose a matchup, toggle injuries / neutral site, optionally plug in market odds — then hit
        <span class="font-semibold text-slate-200">Get Prediction</span> to see projections and true edges vs the market.
      </p>
      <div class="mt-3 inline-flex items-center gap-2 text-xs text-slate-400">
        <span id="sub-status-pill" class="hidden px-3 py-1 rounded-full bg-emerald-500/10 text-emerald-300 border border-emerald-500/40 text-[11px] uppercase tracking-[0.17em]"></span>
      </div>
    </section>

    <!-- CALCULATOR CARD -->
    <section id="calculator-card" class="glass p-6 md:p-8 shadow-2xl">
      <!-- GRID -->
      <div class="grid md:grid-cols-3 gap-6 mb-6 text-sm md:text-base">
        <!-- League & teams -->
        <div class="space-y-4">
          <label class="block text-xs font-semibold uppercase tracking-[0.2em] text-slate-400 mb-1">League</label>
          <select id="league" class="w-full rounded-xl bg-slate-900/70 border border-slate-700/80 px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm">
            <option>NBA</option>
            <option>NFL</option>
            <option>NHL</option>
            <option>MLB</option>
            <option>NCAAB</option>
            <option>NCAAF</option>
          </select>

          <label class="block text-xs font-semibold uppercase tracking-[0.2em] text-slate-400 mt-4 mb-1">Home Team</label>
          <select id="home-team" class="w-full rounded-xl bg-slate-900/70 border border-slate-700/80 px-3 py-2.5 text-sm">
            <option>Select Home Team</option>
          </select>

          <label class="block text-xs font-semibold uppercase tracking-[0.2em] text-slate-400 mt-4 mb-1">Away Team</label>
          <select id="away-team" class="w-full rounded-xl bg-slate-900/70 border border-slate-700/80 px-3 py-2.5 text-sm">
            <option>Select Away Team</option>
          </select>
        </div>

        <!-- Context: neutral / injuries -->
        <div class="space-y-4">
          <div>
            <label class="block text-xs font-semibold uppercase tracking-[0.2em] text-slate-400 mb-2">Context</label>
            <label class="flex items-center gap-2 text-xs text-slate-300">
              <input id="neutral-site" type="checkbox" class="w-4 h-4 rounded border-slate-600 bg-slate-900/80" />
              Neutral site (no home-court / home-field advantage)
            </label>
          </div>

          <div class="mt-4">
            <div class="text-[11px] font-semibold uppercase tracking-[0.2em] text-slate-400 mb-1">Home injuries</div>
            <div class="flex flex-col gap-1 text-xs text-slate-300">
              <label class="inline-flex items-center gap-2">
                <input id="home-major" type="checkbox" class="w-4 h-4 rounded border-slate-600 bg-slate-900/80" />
                Major: key star out / serious limitation
              </label>
              <label class="inline-flex items-center gap-2">
                <input id="home-minor" type="checkbox" class="w-4 h-4 rounded border-slate-600 bg-slate-900/80" />
                Minor: rotation piece out / questionable
              </label>
            </div>
          </div>

          <div class="mt-4">
            <div class="text-[11px] font-semibold uppercase tracking-[0.2em] text-slate-400 mb-1">Away injuries</div>
            <div class="flex flex-col gap-1 text-xs text-slate-300">
              <label class="inline-flex items-center gap-2">
                <input id="away-major" type="checkbox" class="w-4 h-4 rounded border-slate-600 bg-slate-900/80" />
                Major: key star out / serious limitation
              </label>
              <label class="inline-flex items-center gap-2">
                <input id="away-minor" type="checkbox" class="w-4 h-4 rounded border-slate-600 bg-slate-900/80" />
                Minor: rotation piece out / questionable
              </label>
            </div>
          </div>
        </div>

        <!-- Market odds -->
        <div class="space-y-3">
          <div class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-400">
            Market odds (optional)
          </div>
          <p class="text-[11px] text-slate-500">
            Plug in current market numbers to calculate true edges on moneyline, spread, and total.
          </p>

          <div class="grid grid-cols-2 gap-2 mt-1 text-xs">
            <div>
              <label class="block text-[10px] uppercase tracking-[0.2em] text-slate-500 mb-1">
                Home ML
              </label>
              <input id="ml-home" type="number" placeholder="-150"
                class="w-full rounded-lg bg-slate-900/70 border border-slate-700/80 px-2 py-1.5 text-xs" />
            </div>
            <div>
              <label class="block text-[10px] uppercase tracking-[0.2em] text-slate-500 mb-1">
                Away ML
              </label>
              <input id="ml-away" type="number" placeholder="+130"
                class="w-full rounded-lg bg-slate-900/70 border border-slate-700/80 px-2 py-1.5 text-xs" />
            </div>
          </div>

          <div class="grid grid-cols-2 gap-2 mt-2 text-xs">
            <div>
              <label class="block text-[10px] uppercase tracking-[0.2em] text-slate-500 mb-1">
                Spread (home)
              </label>
              <input id="spread" type="number" step="0.5" placeholder="-4.5"
                class="w-full rounded-lg bg-slate-900/70 border border-slate-700/80 px-2 py-1.5 text-xs" />
            </div>
            <div>
              <label class="block text-[10px] uppercase tracking-[0.2em] text-slate-500 mb-1">
                Total
              </label>
              <input id="total" type="number" step="0.5" placeholder="229.5"
                class="w-full rounded-lg bg-slate-900/70 border border-slate-700/80 px-2 py-1.5 text-xs" />
            </div>
          </div>
        </div>
      </div>

      <!-- BUTTON -->
      <div class="flex items-center justify-between gap-4 mt-4 flex-wrap">
        <button
          id="run-btn"
          class="btn-main inline-flex items-center justify-center px-6 py-3 rounded-2xl font-bold text-sm md:text-base tracking-tight transition disabled:opacity-50 disabled:cursor-not-allowed"
        >
          Get Prediction
        </button>
        <div class="text-[11px] text-slate-500">
          Engine: 5,000,000 Monte Carlo simulations • uses live team stats when available
        </div>
      </div>

      <!-- RESULT -->
      <div id="result" class="mt-8 hidden">
        <div class="grid md:grid-cols-3 gap-4 mb-4 text-sm">
          <div class="p-4 rounded-2xl bg-slate-900/80 border border-slate-800/80">
            <div class="text-[11px] uppercase tracking-[0.18em] text-slate-500 mb-2">Matchup</div>
            <div id="matchup" class="text-base font-semibold text-slate-50"></div>
            <div id="location-line" class="text-[11px] text-slate-500 mt-1"></div>
          </div>

          <div class="p-4 rounded-2xl bg-slate-900/80 border border-slate-800/80">
            <div class="text-[11px] uppercase tracking-[0.18em] text-slate-500 mb-2">Projected score</div>
            <div id="score" class="text-lg font-semibold text-emerald-300"></div>
            <div id="winprob" class="text-[11px] text-slate-400 mt-1"></div>
          </div>

          <div class="p-4 rounded-2xl bg-slate-900/80 border border-slate-800/80">
            <div class="text-[11px] uppercase tracking-[0.18em] text-slate-500 mb-2">Edge & bet</div>
            <div id="edge" class="text-xs font-semibold text-emerald-300"></div>
            <div id="bet" class="text-[11px] text-slate-400 mt-1"></div>
          </div>
        </div>

        <div class="mt-4 p-4 rounded-2xl bg-slate-900/80 border border-slate-800/80 text-xs md:text-sm leading-relaxed text-slate-200">
          <div class="text-[11px] uppercase tracking-[0.18em] text-slate-500 mb-2">Model breakdown</div>
          <div id="explanation" class="whitespace-pre-line"></div>
        </div>
      </div>
    </section>
  </main>

  <script>
    // ---------- TEAMS ----------
    const TEAMS = {
      NBA: ["Atlanta Hawks","Boston Celtics","Brooklyn Nets","Charlotte Hornets","Chicago Bulls","Cleveland Cavaliers","Dallas Mavericks","Denver Nuggets","Detroit Pistons","Golden State Warriors","Houston Rockets","Indiana Pacers","LA Clippers","Los Angeles Lakers","Memphis Grizzlies","Miami Heat","Milwaukee Bucks","Minnesota Timberwolves","New Orleans Pelicans","New York Knicks","Oklahoma City Thunder","Orlando Magic","Philadelphia 76ers","Phoenix Suns","Portland Trail Blazers","Sacramento Kings","San Antonio Spurs","Toronto Raptors","Utah Jazz","Washington Wizards"],
      NFL: ["Arizona Cardinals","Atlanta Falcons","Baltimore Ravens","Buffalo Bills","Carolina Panthers","Chicago Bears","Cincinnati Bengals","Cleveland Browns","Dallas Cowboys","Denver Broncos","Detroit Lions","Green Bay Packers","Houston Texans","Indianapolis Colts","Jacksonville Jaguars","Kansas City Chiefs","Las Vegas Raiders","Los Angeles Chargers","Los Angeles Rams","Miami Dolphins","Minnesota Vikings","New England Patriots","New Orleans Saints","New York Giants","New York Jets","Philadelphia Eagles","Pittsburgh Steelers","San Francisco 49ers","Seattle Seahawks","Tampa Bay Buccaneers","Tennessee Titans","Washington Commanders"],
      NHL: ["Anaheim Ducks","Arizona Coyotes","Boston Bruins","Buffalo Sabres","Calgary Flames","Carolina Hurricanes","Chicago Blackhawks","Colorado Avalanche","Columbus Blue Jackets","Dallas Stars","Detroit Red Wings","Edmonton Oilers","Florida Panthers","Los Angeles Kings","Minnesota Wild","Montreal Canadiens","Nashville Predators","New Jersey Devils","New York Islanders","New York Rangers","Ottawa Senators","Philadelphia Flyers","Pittsburgh Penguins","San Jose Sharks","Seattle Kraken","St. Louis Blues","Tampa Bay Lightning","Toronto Maple Leafs","Vancouver Canucks","Vegas Golden Knights","Washington Capitals","Winnipeg Jets"],
      MLB: ["Arizona Diamondbacks","Atlanta Braves","Baltimore Orioles","Boston Red Sox","Chicago Cubs","Chicago White Sox","Cincinnati Reds","Cleveland Guardians","Colorado Rockies","Detroit Tigers","Houston Astros","Kansas City Royals","Los Angeles Angels","Los Angeles Dodgers","Miami Marlins","Milwaukee Brewers","Minnesota Twins","New York Mets","New York Yankees","Oakland Athletics","Philadelphia Phillies","Pittsburgh Pirates","San Diego Padres","San Francisco Giants","Seattle Mariners","St. Louis Cardinals","Tampa Bay Rays","Texas Rangers","Toronto Blue Jays","Washington Nationals"],
      NCAAB: ["Abilene Christian","Air Force","Akron","Alabama","Alabama A&M","Alabama State","Alcorn State","American","App State","Arizona","Arizona State","Arkansas","Little Rock","Arkansas State","Army","Auburn","Austin Peay","Ball State","Baylor","Belmont","Bethune-Cookman","Binghamton","Boise State","Boston College","Boston U","Bowling Green","Bradley","Brown","Bryant","Bucknell","Butler","BYU","Cal","Cal Baptist","Cal Poly","Cal State Bakersfield","Cal State Fullerton","Cal State Northridge","Campbell","Canisius","Central Arkansas","Central Connecticut","Charleston","Charlotte","Chattanooga","Chicago State","Cincinnati","The Citadel","Clemson","Cleveland State","Coastal Carolina","Colgate","Colorado","Colorado State","Columbia","Coppin State","Cornell","Creighton","Dartmouth","Davidson","Dayton","Delaware","Delaware State","Denver","DePaul","Detroit Mercy","Drake","Drexel","Duke","Duquesne","East Carolina","Eastern Illinois","Eastern Kentucky","Eastern Michigan","Eastern Washington","Elon","Evansville","Fairfield","Fairleigh Dickinson","Florida","Florida A&M","Florida Atlantic","Florida Gulf Coast","Florida International","Florida State","Fordham","Fresno State","Furman","Gardner-Webb","George Mason","George Washington","Georgetown","Georgia","Georgia Southern","Georgia State","Georgia Tech","Gonzaga","Grambling","Grand Canyon","Green Bay","Hampton","Harvard","Hawaii","High Point","Hofstra","Holy Cross","Houston","Howard","Idaho","Idaho State","Illinois","Illinois State","Indiana","Indiana State","Iona","Iowa","Iowa State","IUPUI","Jackson State","Jacksonville","Jacksonville State","James Madison","Kansas","Kansas State","Kennesaw State","Kent State","Kentucky","La Salle","Lafayette","Lamar","Lehigh","Liberty","Lindenwood","Lipscomb","Long Beach State","Long Island","Longwood","Louisiana","Louisiana Tech","Louisville","Loyola Chicago","Loyola Marymount","Loyola Maryland","LSU","Maine","Manhattan","Marist","Marquette","Marshall","Maryland","UMass","McNeese","Memphis","Mercer","Miami","Miami (OH)","Michigan","Michigan State","Middle Tennessee","Milwaukee","Minnesota","Mississippi State","Missouri","Missouri State","Monmouth","Montana","Montana State","Morehead State","Morgan State","Mount St. Mary's","Murray State","Navy","NC State","Nebraska","Nevada","New Hampshire","New Mexico","New Mexico State","Niagara","Nicholls","Norfolk State","North Alabama","North Carolina","NC A&T","NC Central","North Dakota","North Dakota State","North Florida","Northeastern","Northern Arizona","Northern Colorado","Northern Illinois","Northern Iowa","Northern Kentucky","North Texas","Northwestern","Northwestern State","Notre Dame","Oakland","Ohio","Ohio State","Oklahoma","Oklahoma State","Old Dominion","Ole Miss","Omaha","Oral Roberts","Oregon","Oregon State","Pacific","Penn","Penn State","Pepperdine","Pittsburgh","Portland","Portland State","Prairie View","Presbyterian","Princeton","Providence","Purdue","Queens","Quinnipiac","Radford","Rhode Island","Rice","Richmond","Rider","Robert Morris","Rutgers","Sacramento State","Sacred Heart","Saint Joseph's","Saint Louis","Saint Mary's","Saint Peter's","Samford","Sam Houston","San Diego","San Diego State","San Francisco","San Jose State","Santa Clara","Seattle","Seton Hall","Siena","South Alabama","South Carolina","South Carolina State","South Dakota","South Dakota State","South Florida","Southeast Missouri","Southeastern Louisiana","Southern","Southern Illinois","Southern Miss","Southern Utah","St. Bonaventure","St. Francis (PA)","St. John's","Stanford","Stephen F. Austin","Stetson","Stonehill","Stony Brook","Syracuse","Tarleton","TCU","Temple","Tennessee","Tennessee State","Tennessee Tech","Texas","Texas A&M","Texas A&M-Commerce","Texas Southern","Texas State","Texas Tech","Toledo","Towson","Troy","Tulane","Tulsa","UAB","UC Davis","UC Irvine","UC Riverside","UC San Diego","UC Santa Barbara","UCF","UCLA","UMass Lowell","UMBC","UNC Asheville","UNC Greensboro","UNC Wilmington","UNLV","USC","UT Arlington","UTEP","UT Martin","UT Rio Grande Valley","UTSA","Utah","Utah State","Utah Tech","Utah Valley","Valparaiso","Vanderbilt","VCU","Vermont","Villanova","Virginia","Virginia Tech","VMI","Wagner","Wake Forest","Washington","Washington State","Weber State","West Virginia","Western Carolina","Western Illinois","Western Kentucky","Western Michigan","Wichita State","William & Mary","Winthrop","Wisconsin","Wofford","Wright State","Wyoming","Xavier","Yale","Youngstown State"],
      NCAAF: ["Air Force","Akron","Alabama","App State","Arizona","Arizona State","Arkansas","Arkansas State","Army","Auburn","Ball State","Baylor","Boise State","Boston College","Bowling Green","Buffalo","BYU","California","Central Michigan","Charlotte","Cincinnati","Clemson","Coastal Carolina","Colorado","Colorado State","UConn","Duke","East Carolina","Eastern Michigan","FIU","Florida","Florida Atlantic","Florida State","Fresno State","Georgia","Georgia Southern","Georgia State","Georgia Tech","Hawaii","Houston","Illinois","Indiana","Iowa","Iowa State","Jacksonville State","James Madison","Kansas","Kansas State","Kent State","Kentucky","Kennesaw State","Liberty","Louisiana","Louisiana Tech","Louisville","LSU","Marshall","Maryland","Massachusetts","Memphis","Miami","Miami (OH)","Michigan","Michigan State","Middle Tennessee","Minnesota","Mississippi State","Missouri","Navy","Nebraska","Nevada","New Mexico","New Mexico State","North Carolina","NC State","North Texas","Northern Illinois","Northwestern","Notre Dame","Ohio","Ohio State","Oklahoma","Oklahoma State","Old Dominion","Ole Miss","Oregon","Oregon State","Penn State","Pittsburgh","Purdue","Rice","Rutgers","Sam Houston","San Diego State","San Jose State","SMU","South Alabama","South Carolina","South Florida","Southern Miss","Stanford","Syracuse","TCU","Temple","Tennessee","Texas","Texas A&M","Texas State","Texas Tech","Toledo","Troy","Tulane","Tulsa","UAB","UCF","UCLA","UNLV","USC","UTEP","UTSA","Utah","Utah State","Vanderbilt","Virginia","Virginia Tech","Wake Forest","Washington","Washington State","West Virginia","Western Kentucky","Western Michigan","Wisconsin","Wyoming"]
    };

    function populateTeams() {
      const league = document.getElementById("league").value;
      const teams = TEAMS[league] || [];
      ["home-team", "away-team"].forEach((id) => {
        const el = document.getElementById(id);
        el.innerHTML =
          "<option>Select Team</option>" +
          teams.map((t) => `<option>${t}</option>`).join("");
      });
    }

    document.getElementById("league").addEventListener("change", populateTeams);
    populateTeams();

    function getCookie(name) {
      const parts = (`; ${document.cookie}`).split(`; ${name}=`);
      if (parts.length === 2) return parts.pop().split(";").shift();
    }
    function getToken() {
      return getCookie("appSession") || getCookie("token") || null;
    }

    // ---------- SUB / AUTH GATE ----------
    const loggedOut = document.getElementById("logged-out");
    const freeOnly = document.getElementById("free-only");
    const subStatusPill = document.getElementById("sub-status-pill");
    const runBtn = document.getElementById("run-btn");

    const token = getToken();
    if (!token) {
      loggedOut.classList.remove("hidden");
      runBtn.disabled = true;
    } else {
      fetch("/.netlify/functions/get-sub-status", {
        headers: { Authorization: `Bearer ${token}` }
      })
        .then((r) => r.ok ? r.json() : { status: "free" })
        .then((data) => {
          const status = data.status || "free";
          if (status === "active" || status === "trialing") {
            subStatusPill.classList.remove("hidden");
            subStatusPill.textContent =
              status === "trialing" ? "Trial active" : "Subscriber";
            runBtn.disabled = false;
          } else {
            freeOnly.classList.remove("hidden");
            subStatusPill.classList.remove("hidden");
            subStatusPill.textContent = "Free tier";
            runBtn.disabled = true;
          }
        })
        .catch(() => {
          freeOnly.classList.remove("hidden");
          runBtn.disabled = true;
        });
    }

    document.getElementById("logout-btn").addEventListener("click", () => {
      document.cookie = "appSession=; Max-Age=0; path=/";
      document.cookie = "token=; Max-Age=0; path=/";
      location.reload();
    });

    // ---------- PREDICTION HANDLER ----------
    document.addEventListener("click", async (e) => {
      if (e.target.id !== "run-btn") return;

      const league = document.getElementById("league").value;
      const home = document.getElementById("home-team").value;
      const away = document.getElementById("away-team").value;

      if (!home || !away || home.includes("Select") || away.includes("Select")) {
        alert("Please select both teams.");
        return;
      }

      const neutralSite = document.getElementById("neutral-site").checked;
      const homeMajor = document.getElementById("home-major").checked;
      const homeMinor = document.getElementById("home-minor").checked;
      const awayMajor = document.getElementById("away-major").checked;
      const awayMinor = document.getElementById("away-minor").checked;

      const mlHome = document.getElementById("ml-home").value.trim();
      const mlAway = document.getElementById("ml-away").value.trim();
      const spread = document.getElementById("spread").value.trim();
      const total = document.getElementById("total").value.trim();

      const market = {};
      if (mlHome && mlAway) {
        market.homeMoneyline = Number(mlHome);
        market.awayMoneyline = Number(mlAway);
      }
      if (spread) market.spread = Number(spread);
      if (total) market.total = Number(total);

      const hasMarket =
        market.homeMoneyline != null ||
        market.awayMoneyline != null ||
        market.spread != null ||
        market.total != null;

      const btn = e.target;
      btn.disabled = true;
      btn.textContent = "Running 5,000,000 simulations...";

      try {
        const res = await fetch("/.netlify/functions/predict", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            league,
            homeTeam: home,
            awayTeam: away,
            neutralSite,
            homeMajorInjury: homeMajor,
            homeMinorInjury: homeMinor,
            awayMajorInjury: awayMajor,
            awayMinorInjury: awayMinor,
            market: hasMarket ? market : null
          })
        });

        if (!res.ok) {
          const text = await res.text();
          throw new Error(text || "Server error");
        }

        const data = await res.json();

        document.getElementById("matchup").textContent = data.matchup;
        document.getElementById("score").textContent =
          `${data.homeTeam} ${data.projectedHomeScore} – ${data.awayTeam} ${data.projectedAwayScore}`;
        document.getElementById("winprob").textContent =
          `${data.homeTeam} wins ${data.winProbability} of simulations.`;
        document.getElementById("edge").textContent = data.edge;
        document.getElementById("bet").textContent = data.recommendedBet || "";

        document.getElementById("location-line").textContent =
          data.neutralSite
            ? "Neutral site"
            : `Standard home advantage applied for ${data.homeTeam}.`;

        document.getElementById("explanation").textContent =
          data.explanation || "";

        const result = document.getElementById("result");
        result.classList.remove("hidden");
        result.scrollIntoView({ behavior: "smooth", block: "start" });
      } catch (err) {
        alert("Error: " + err.message);
      }

      btn.disabled = false;
      btn.textContent = "Get Prediction";
    });
  </script>
</body>
</html>
