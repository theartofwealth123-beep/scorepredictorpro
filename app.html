<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ScorePredictor Pro</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: system-ui, sans-serif; background: #0f0f23; color: white; min-height: 100vh; padding: 2rem; }
    .btn { background: linear-gradient(45deg, #7c3aed, #ec4899); padding: 1.5rem 3rem; font-size: 2rem; font-weight: 900; border-radius: 1.5rem; box-shadow: 0 20px 40px rgba(124,58,237,0.5); transition: all 0.2s; cursor: pointer; }
    .btn:hover { transform: translateY(-8px); box-shadow: 0 30px 60px rgba(124,58,237,0.7); }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; }
    .result { background: rgba(0,0,0,0.6); backdrop-filter: blur(12px); border-radius: 2rem; padding: 3rem; margin-top: 3rem; }
  </style>
</head>
<body>

<div class="max-w-6xl mx-auto text-center">
  <h1 class="text-8xl font-black bg-gradient-to-r from-violet-400 to-pink-600 bg-clip-text text-transparent">
    ScorePredictor Pro
  </h1>
  <p class="text-4xl mt-4 text-green-400 font-bold">ADMIN — LOCKED & LOADED</p>

  <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-12 mt-16">
    <h2 class="text-5xl font-bold mb-10">50,000 Simulation Beast</h2>

    <div class="grid md:grid-cols-3 gap-8 mb-12 text-xl">
      <select id="league" class="bg-white/20 rounded-xl px-6 py-5">
        <option>NBA</option><option>NFL</option><option>NHL</option><option>MLB</option><option>NCAAB</option><option>NCAAF</option>
      </select>
      <select id="home-team" class="bg-white/20 rounded-xl px-6 py-5"><option>Select Home</option></select>
      <select id="away-team" class="bg-white/20 rounded-xl px-6 py-5"><option>Select Away</option></select>
    </div>

    <button id="run-btn" class="btn">RUN 50,000 SIMULATIONS</button>

    <div id="result" class="result hidden">
      <h3 id="matchup" class="text-6xl font-black mb-8"></h3>
      <div class="grid md:grid-cols-3 gap-10 text-center">
        <div><p class="text-2xl opacity-80">Projected Score</p><p id="score" class="text-7xl font-black text-green-400"></p></div>
        <div><p class="text-2xl opacity-80">Home Win %</p><p id="winprob" class="text-7xl font-black text-yellow-400"></p></div>
        <div><p class="text-2xl opacity-80">Edge</p><p id="edge" class="text-8xl font-black text-green-400"></p></div>
      </div>
      <div class="mt-12 text-left max-w-3xl mx-auto text-lg">
        <p class="font-bold text-pink-400 text-2xl">Model Used:</p>
        <p>• League Avg: <span id="ppg" class="text-white font-bold"></span> PPG</p>
        <p>• Home Adv: <span id="homeadv" class="text-green-400 font-bold"></span></p>
        <p>• Simulations: <span class="text-yellow-400 font-bold">50,000</span></p>
        <p class="mt-6 text-xl font-medium" id="explanation"></p>
      </div>
    </div>
  </div>
</div>

<script>
const TEAMS = { /* ← your full 351 NCAAB + 136 NCAAF list from earlier — it's still in your repo */ 
  NBA: ["Atlanta Hawks","Boston Celtics","Brooklyn Nets","Charlotte Hornets","Chicago Bulls","Cleveland Cavaliers","Dallas Mavericks","Denver Nuggets","Detroit Pistons","Golden State Warriors","Houston Rockets","Indiana Pacers","LA Clippers","Los Angeles Lakers","Memphis Grizzlies","Miami Heat","Milwaukee Bucks","Minnesota Timberwolves","New Orleans Pelicans","New York Knicks","Oklahoma City Thunder","Orlando Magic","Philadelphia 76ers","Phoenix Suns","Portland Trail Blazers","Sacramento Kings","San Antonio Spurs","Toronto Raptors","Utah Jazz","Washington Wizards"],
  NFL: ["Arizona Cardinals","Atlanta Falcons","Baltimore Ravens","Buffalo Bills","Carolina Panthers","Chicago Bears","Cincinnati Bengals","Cleveland Browns","Dallas Cowboys","Denver Broncos","Detroit Lions","Green Bay Packers","Houston Texans","Indianapolis Colts","Jacksonville Jaguars","Kansas City Chiefs","Las Vegas Raiders","Los Angeles Chargers","Los Angeles Rams","Miami Dolphins","Minnesota Vikings","New England Patriots","New Orleans Saints","New York Giants","New York Jets","Philadelphia Eagles","Pittsburgh Steelers","San Francisco 49ers","Seattle Seahawks","Tampa Bay Buccaneers","Tennessee Titans","Washington Commanders"],
  NCAAB: ["Abilene Christian","Air Force","Akron","Alabama","Arizona","Arkansas","Auburn","Baylor","Boston College","BYU","Cincinnati","Clemson","Creighton","Duke","Florida","Gonzaga","Houston","Illinois","Iowa State","Kansas","Kentucky","Marquette","Michigan State","North Carolina","Purdue","Tennessee","Texas Tech","UCLA","UConn","Villanova","Wisconsin","Xavier","Yale","Wyoming","Sacred Heart","St. John's","St. Mary's","Stanford","Syracuse","TCU","Texas","Texas A&M","Utah","Virginia","Wake Forest","West Virginia","Wichita State","Wright State","Youngstown State","Little Rock","Army","Cal Baptist","Campbell","Charlotte","Coastal Carolina","Detroit Mercy","East Carolina","Florida Atlantic","Grand Canyon","High Point","James Madison","Liberty","Longwood","Loyola Chicago","McNeese","Memphis","Norfolk State","Oral Roberts","Queens","Richmond","Saint Mary's","Samford","San Francisco","Seattle","Stephen F. Austin","Tarleton","UC Irvine","UNLV","Utah Valley","VCU","VMI","Western Kentucky","Winthrop","UNC Asheville","UNC Greensboro","UNC Wilmington","Valparaiso","Vanderbilt","Vermont","Villanova","Virginia Tech","Wagner","Washington State","Weber State","West Virginia","Western Carolina","Western Illinois","Western Kentucky","Western Michigan","William & Mary","Winthrop","Wisconsin","Wofford","Wright State","Wyoming","Xavier","Yale","Youngstown State"],
  NCAAF: ["Air Force","Akron","Alabama","App State","Arizona","Arizona State","Arkansas","Arkansas State","Army","Auburn","Ball State","Baylor","Boise State","Boston College","Bowling Green","Buffalo","BYU","California","Central Michigan","Charlotte","Cincinnati","Clemson","Coastal Carolina","Colorado","Colorado State","UConn","Duke","East Carolina","Eastern Michigan","FIU","Florida","Florida Atlantic","Florida State","Fresno State","Georgia","Georgia Southern","Georgia State","Georgia Tech","Hawaii","Houston","Illinois","Indiana","Iowa","Iowa State","Jacksonville State","James Madison","Kansas","Kansas State","Kent State","Kentucky","Kennesaw State","Liberty","Louisiana","Louisiana Tech","Louisville","LSU","Marshall","Maryland","Massachusetts","Memphis","Miami","Miami (OH)","Michigan","Michigan State","Middle Tennessee","Minnesota","Mississippi State","Missouri","Navy","Nebraska","Nevada","New Mexico","New Mexico State","North Carolina","NC State","North Texas","Northern Illinois","Northwestern","Notre Dame","Ohio","Ohio State","Oklahoma","Oklahoma State","Old Dominion","Ole Miss","Oregon","Oregon State","Penn State","Pittsburgh","Purdue","Rice","Rutgers","Sam Houston","San Diego State","San Jose State","SMU","South Alabama","South Carolina","South Florida","Southern Miss","Stanford","Syracuse","TCU","Temple","Tennessee","Texas","Texas A&M","Texas State","Texas Tech","Toledo","Troy","Tulane","Tulsa","UAB","UCF","UCLA","UNLV","USC","UTEP","UTSA","Utah","Utah State","Vanderbilt","Virginia","Virginia Tech","Wake Forest","Washington","Washington State","West Virginia","Western Kentucky","Western Michigan","Wisconsin","Wyoming"]
};

function populateTeams() {
  const league = document.getElementById("league").value;
  const teams = TEAMS[league] || [];
  ["home-team", "away-team"].forEach(id => {
    const el = document.getElementById(id);
    el.innerHTML = "<option>Select Team</option>" + teams.map(t => `<option>${t}</option>`).join("");
  });
}
document.getElementById("league").addEventListener("change", populateTeams);
populateTeams();

function getToken() {
  return new URLSearchParams(window.location.search).get("token") ||
         document.cookie.split("; ").find(c => c.startsWith("token="))?.split("=")[1];
}

document.addEventListener("click", async e => {
  if (e.target.id !== "run-btn") return;
  const league = document.getElementById("league").value;
  const home = document.getElementById("home-team").value;
  const away = document.getElementById("away-team").value;
  if (!home || !away || home.includes("Select") || away.includes("Select")) return alert("Pick both teams");

  const btn = e.target;
  btn.disabled = true;
  btn.textContent = "Running 50,000 sims...";

  const token = getToken();
  try {
    const res = await fetch("/.netlify/functions/predict-matchup", {
      method: "POST",
      headers: { "Authorization": `Bearer ${token}`, "Content-Type": "application/json" },
      body: JSON.stringify({ league, homeTeam: home, awayTeam: away })
    });
    const data = await res.json();

    document.getElementById("matchup").textContent = data.matchup;
    document.getElementById("score").textContent = data.projectedScore;
    document.getElementById("winprob").textContent = data.winProbability[home];
    document.getElementById("edge").textContent = data.edgeVsMarket;
    document.getElementById("ppg").textContent = data.modelStats.leagueAvgPPG;
    document.getElementById("homeadv").textContent = data.modelStats.homeAdv;
    document.getElementById("explanation").textContent = data.explanation;

    document.getElementById("result").classList.remove("hidden");
    document.getElementById("result").scrollIntoView({behavior: "smooth"});
catch (err) {
  // Silent retry — Netlify cold starts are dead to us
  setTimeout(() => {
    e.target.click(); // auto re-click once
  }, 800);
}
</script>
</body>
</html>